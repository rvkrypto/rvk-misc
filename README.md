
#	rvk-misc

2024-07-23	Markku-Juhani O. Saarinen  mjos@iki.fi

A bunch of tests for RISC-V Cryptographic Extensions + their intrinsics.

Currently the intrinsics require llvm cross compiler built from git sources (19.0.0git).


Compiling, assuming all of the (currently somewhat bleeding-edge) dependencies:
```
mjos@zinc:~/rv/rvk-misc$ make
riscv64-unknown-linux-gnu-clang -march=rv64gcv_zkn_zks_zbb_zvbb_zvbc_zvkg_zvkned_zvkn_zvks_zvl256b -menable-experimental-extensions -Wall -Wextra -Wshadow -Wno-unused-parameter  -DRVK_ALGTEST_VERBOSE_SIO -O3 -g -I. -c test_main.c -o test_main.o
(...)
riscv64-unknown-linux-gnu-clang -static -march=rv64gcv_zkn_zks_zbb_zvbb_zvbc_zvkg_zvkned_zvkn_zvks_zvl256b -menable-experimental-extensions -Wall -Wextra -Wshadow -Wno-unused-parameter  -DRVK_ALGTEST_VERBOSE_SIO -O3 -g -I. -o xtest test_main.o test_rvkat_sio.o aes/aes_api.o aes/aes_otf_rvk64.o aes/aes_rvk32.o aes/aes_rvk64.o aes/test_aes.o gcm/gcm_api.o gcm/gcm_gfmul_rv32.o gcm/gcm_gfmul_rv64.o gcm/test_gcm.o present/present.o present/present_rv32.o present/present_rv64.o present/test_present.o sha2/sha2_api.o sha2/sha2_cf256_rvk.o sha2/sha2_cf512_rvk32.o sha2/sha2_cf512_rvk64.o sha2/test_sha2.o sha3/sha3_api.o sha3/sha3_f1600_rvb32.o sha3/sha3_f1600_rvb64.o sha3/test_sha3.o sm3/sm3_api.o sm3/sm3_cf256_zksh.o sm3/test_sm3.o sm4/sm4_rvk.o sm4/test_sm4.o sm3/sm3_cf256_zvksh.o 
```

Running:
```
mjos@zinc:~/rv/rvk-misc$ make run
spike	--isa=rv64gcv_zkn_zks_zbb_zvbb_zvbc_zvkg_zvkned_zvkn_zvks_zvl256b_zicntr_zihpm  pk xtest
[INFO] === AES64 ===
[PASS] AES-128 Enc 69C4E0D86A7B0430D8CDB78070B4C55A
[PASS] AES-128 Dec 00112233445566778899AABBCCDDEEFF
[PASS] AES-192 Enc DDA97CA4864CDFE06EAF70A0EC0D7191
[PASS] AES-192 Dec 00112233445566778899AABBCCDDEEFF
[PASS] AES-256 Enc 8EA2B7CA516745BFEAFC49904B496089
[PASS] AES-256 Dec 00112233445566778899AABBCCDDEEFF
[PASS] AES-128 Enc 3AD77BB40D7A3660A89ECAF32466EF97
[PASS] AES-128 Dec 6BC1BEE22E409F96E93D7E117393172A
[PASS] AES-192 Enc 974104846D0AD3AD7734ECB3ECEE4EEF
[PASS] AES-192 Dec AE2D8A571E03AC9C9EB76FAC45AF8E51
[PASS] AES-256 Enc B6ED21B99CA6F4F9F153E7B1BEAFED1D
[PASS] AES-256 Dec 30C81C46A35CE411E5FBC1191A0A52EF
[INFO] === AES64 / On-the-fly keying ===
[PASS] AES-128 Enc 69C4E0D86A7B0430D8CDB78070B4C55A
[PASS] AES-128 Dec 00112233445566778899AABBCCDDEEFF
[PASS] AES-192 Enc DDA97CA4864CDFE06EAF70A0EC0D7191
[PASS] AES-192 Dec 00112233445566778899AABBCCDDEEFF
[PASS] AES-256 Enc 8EA2B7CA516745BFEAFC49904B496089
[PASS] AES-256 Dec 00112233445566778899AABBCCDDEEFF
[PASS] AES-128 Enc 3AD77BB40D7A3660A89ECAF32466EF97
[PASS] AES-128 Dec 6BC1BEE22E409F96E93D7E117393172A
[PASS] AES-192 Enc 974104846D0AD3AD7734ECB3ECEE4EEF
[PASS] AES-192 Dec AE2D8A571E03AC9C9EB76FAC45AF8E51
[PASS] AES-256 Enc B6ED21B99CA6F4F9F153E7B1BEAFED1D
[PASS] AES-256 Dec 30C81C46A35CE411E5FBC1191A0A52EF
[INFO] === GCM using ghash_mul_rv64() ===
[PASS] GCM AES-128 2CCDA4A5415CB91E135C2A0F78C9B2FDB36D1DF9B9D5E596F83E8B7F52971CB3
[PASS] GCM AES-128 verify / corrupt test | WANT= 0	HAVE= 0
[PASS] GCM AES-192 5AB8AC904E7D4A627EE327B4629B686319936ABC709E8C0FB6817CB16D0C4F7662BFEA782D6A05CD04030C433639B969
[PASS] GCM AES-192 verify / corrupt test | WANT= 0	HAVE= 0
[PASS] GCM AES-256 91FBD061DDC5A7FCC9513FCDFDC9C3A7C5D4D64CEDF6A9C24AB8A77C36EEFBF1C5DC00BC50121B96456C8CD8B6FF1F8B3E480F30096D340F3D5C42D82A6F475DEF23EB
[PASS] GCM AES-256 verify / corrupt test | WANT= 0	HAVE= 0
[INFO] === SHA2-256 using sha2_cf256_rvk() ===
[PASS] SHA2-256 BA7816BF8F01CFEA414140DE5DAE2223B00361A396177A9CB410FF61F20015AD
[PASS] SHA2-224 03842600C86F5CD60C3A2147A067CB962A05303C3488B05CB45327BD
[PASS] SHA2-256 E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
[PASS] SHA2-256 6595A2EF537A69BA8583DFBF7F5BEC0AB1F93CE4C8EE1916EFF44A93AF5749C4
[PASS] SHA2-256 CFB88D6FAF2DE3A69D36195ACEC2E255E2AF2B7D933997F348E09F6CE5758360
[PASS] SHA2-256 42E61E174FBB3897D6DD6CEF3DD2802FE67B331953B06114A65C772859DFC1AA
[PASS] SHA2-256 3C593AA539FDCDAE516CDF2F15000F6634185C88F505B39775FB9AB137A10AA2
[INFO] === SHA2-512 using sha2_cf512_rvk64() ===
[PASS] SHA2-512 DDAF35A193617ABACC417349AE20413112E6FA4E89A97EA20A9EEEE64B55D39A2192992A274FC1A836BA3C23A3FEEBBD454D4423643CE80E2A9AC94FA54CA49F
[PASS] SHA2-512 8E959B75DAE313DA8CF4F72814FC143F8F7779C6EB9F7FA17299AEADB6889018501D289E4900F7E4331B99DEC4B5433AC7D329EEB6DD26545E96E55B874BE909
[PASS] SHA2-384 38B060A751AC96384CD9327EB1B1E36A21FDB71114BE07434C0CC7BF63F6E1DA274EDEBFE76F65FBD51AD2F14898B95B
[PASS] SHA2-384 E7089D72945CEF851E689B4409CFB63D135F0B5CDFB0DAC6C3A292DD70371AB4B79DA1997D7992906AC7213502662920
[INFO] === SHA3 using sha3_f1600_rvb64() ===
[PASS] KECCAK-P 1581ED5252B07483009456B676A6F71D7D79518A4B1965F7450576D1437B47206A60F6F3A48B5FD193D48D7C4F14D7A13FFD38519693D130BEE31B9572947E485A7ADACB58A8F30C887FB19B384EE52F8F269F0DDE38730B7F6D258BF5DFEF556A3E2CEB943E35C8111F908C94F62A2EA69D30CA0CDE73E8E2314D946CC2AFF7D715C48C80EAF5A0CFD83E7E4331F55321D2A4433B1F7F7785E999B43CA60CFD3023D1C5C055C0D4DFA7E0A68AE52FA7A348997C93F51A42880834713010165E334A7E293AF453D1
[PASS] SHA3-224 6B4E03423667DBB73B6E15454F0EB1ABD4597F9A1B078E3F5B5A6BC7
[PASS] SHA3-256 64537B87892835FF0963EF9AD5145AB4CFCE5D303A0CB0415B3B03F9D16E7D6B
[PASS] SHA3-384 D1C0FA85C8D183BEFF99AD9D752B263E286B477F79F0710B010317017397813344B99DAF3BB7B1BC5E8D722BAC85943A
[PASS] SHA3-512 6E8B8BD195BDD560689AF2348BDC74AB7CD05ED8B9A57711E9BE71E9726FDA4591FEE12205EDACAF82FFBBAF16DFF9E702A708862080166C2FF6BA379BC7FFC2
[PASS] SHAKE128 9DE6FFACF3E59693A3DE81B02F7DB77A
[PASS] SHAKE256 89F2373E131A899B4BA27F6DA606716A5E289FD530AE066BB8B11DC023DACBD6
[PASS] SHAKE128 43E41B45A653F2A5C4492C1ADD544512DDA2529833462B71A41A45BE97290B6F
[PASS] SHAKE256 AB0BAE316339894304E35877B0C28A9B1FD166C796B9CC258A064A8F57E27F2A
[PASS] SHAKE128 44C9FB359FD56AC0A9A75A743CFF6862F17D7259AB075216C0699511643B6439
[PASS] SHAKE256 6A1A9D7846436E4DCA5728B6F760EEF0CA92BF0BE5615E96959D767197A0BEEB
[INFO] === PRESENT using present_rv64.c ===
[PASS] PRESENT-80 Encrypt 5579C1387B228445
[PASS] PRESENT-80 Decrypt 0000000000000000
[PASS] PRESENT-80 Encrypt E72C46C0F5945049
[PASS] PRESENT-80 Decrypt 0000000000000000
[PASS] PRESENT-80 Encrypt A112FFC72F68417B
[PASS] PRESENT-80 Decrypt FFFFFFFFFFFFFFFF
[PASS] PRESENT-80 Encrypt 3333DCD3213210D2
[PASS] PRESENT-80 Decrypt FFFFFFFFFFFFFFFF
[PASS] PRESENT-128 Encrypt 96DB702A2E6900AF
[PASS] PRESENT-128 Decrypt 0000000000000000
[PASS] PRESENT-128 Encrypt 13238C710272A5D8
[PASS] PRESENT-128 Decrypt 0000000000000000
[PASS] PRESENT-128 Encrypt 3C6019E5E5EDD563
[PASS] PRESENT-128 Decrypt FFFFFFFFFFFFFFFF
[PASS] PRESENT-128 Encrypt 628D9FBD4218E5B4
[PASS] PRESENT-128 Decrypt FFFFFFFFFFFFFFFF
[PASS] PRESENT-128 Encrypt 0123456789ABCDEF
[PASS] PRESENT-128 Decrypt DA0E854A1E8D03E0
[INFO] === SM4 ===
[PASS] SM4 Encrypt 681EDF34D206965E86B3E94F536E4246
[PASS] SM4 Decrypt 0123456789ABCDEFFEDCBA9876543210
[PASS] SM4 Encrypt F766678F13F01ADEAC1B3EA955ADB594
[PASS] SM4 Decrypt 000102030405060708090A0B0C0D0E0F
[PASS] SM4 Encrypt 865DE90D6B6E99273E2D44859D9C16DF
[PASS] SM4 Decrypt D294D879A1F02C7C5906D6C2D0C54D9F
[PASS] SM4 Encrypt 94CFE3F59E8507FEC41DBE738CCD53E1
[PASS] SM4 Decrypt A27EE076E48E6F389710EC7B5E8A3BE5
[INFO] === SM3 (sm3_cf256_zksh) ===
[PASS] SM3-256 66C7F0F462EEEDD9D1F2D46BDC10E4E24167C4875CF2F7A2297DA02B8F4BA8E0
[PASS] SM3-256 DEBE9FF92275B8A138604889C18E5A4D6FDB70E5387E5765293DCBA39C0C5732
[PASS] SM3-256 59D171DBFD251D5A4CD77D6BA2B7109B7D64A4CD7FA8182BEB100A016FA3AC44
[INFO] instret / 256 bytes: 8413
[INFO] === SM3 (sm3_cf256_zvksh_lmul1) ===
[PASS] SM3-256 66C7F0F462EEEDD9D1F2D46BDC10E4E24167C4875CF2F7A2297DA02B8F4BA8E0
[PASS] SM3-256 DEBE9FF92275B8A138604889C18E5A4D6FDB70E5387E5765293DCBA39C0C5732
[PASS] SM3-256 59D171DBFD251D5A4CD77D6BA2B7109B7D64A4CD7FA8182BEB100A016FA3AC44
[INFO] instret / 256 bytes: 361
[PASS] === TOTAL 0 ERRORS.
mjos@zinc:~/rv/rvk-misc$ 
```
